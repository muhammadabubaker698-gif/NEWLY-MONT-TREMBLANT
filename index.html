<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Mont Tremblant Limo Services | Luxury Chauffeur</title>
<meta name="description" content="Luxury chauffeur service in Mont-Tremblant. Escalade, Suburban, Denali, QX60, Tesla & Sprinter. Minimum 3 hours. Call or WhatsApp +1 (514) 293-3170." />
<link rel="canonical" href="https://monttremblantlimoservices.com/" />

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">

<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@type":"LocalBusiness",
  "name":"Mont Tremblant Limo Services",
  "url":"https://monttremblantlimoservices.com/",
  "telephone":"+1-514-293-3170",
  "description":"Luxury chauffeur service in Mont-Tremblant. Premium vehicles for airport transfers, hourly bookings, ski trips, corporate travel, and special events. Minimum 3 hours.",
  "areaServed":[
    {"@type":"City","name":"Mont-Tremblant"},
    {"@type":"City","name":"Montr√©al"},
    {"@type":"City","name":"Ottawa"},
    {"@type":"City","name":"Qu√©bec City"},
    {"@type":"City","name":"New York"},
    {"@type":"City","name":"Boston"},
    {"@type":"AdministrativeArea","name":"New Jersey"}
  ],
  "address":{
    "@type":"PostalAddress",
    "addressLocality":"Mont-Tremblant",
    "addressRegion":"QC",
    "addressCountry":"CA"
  },
  "image":[ "https://monttremblantlimoservices.com/Tremblant.jpg" ],
  "sameAs":[ "https://wa.me/15142933170" ]
}
</script>

<style>
  :root{
    --bg:#ffffff;
    --ink:#0b1220;
    --muted: rgba(11,18,32,.68);
    --line: rgba(11,18,32,.10);
    --shadow: 0 18px 55px rgba(0,0,0,.14);
    --shadow2: 0 10px 28px rgba(0,0,0,.10);
    --radius: 16px;
    --max: 1160px;
    --gradA:#ff2e63;
    --gradB:#ff7a00;
    --good:#0f9d58;
    --bad:#b00020;
  }

  *{box-sizing:border-box;margin:0;padding:0}
  html{scroll-behavior:smooth}
  body{
    font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    background: var(--bg);
    color: var(--ink);
    line-height: 1.6;
    font-size: 16px;
    overflow-x:hidden;
  }
  a{color:inherit;text-decoration:none}
  .container{max-width:var(--max);margin:0 auto;padding: 0 18px}
  section{ scroll-margin-top: 96px; }
  main{padding-bottom: 64px}

  header{
    position: sticky;
    top:0;
    z-index:50;
    background: rgba(255,255,255,.92);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--line);
  }
  .nav{
    height: 76px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:14px;
  }
  .brand{
    display:flex;
    align-items:center;
    gap:12px;
    font-weight: 950;
    letter-spacing: .4px;
  }
  .logo{
    width: 38px; height: 38px;
    border-radius: 12px;
    background: #0b1220;
    color:#fff;
    display:grid;
    place-items:center;
    font-weight: 950;
  }
  .links{
    display:flex;
    align-items:center;
    gap: 12px;
    flex-wrap:wrap;
    justify-content:center;
  }
  .links a{
    color: rgba(11,18,32,.78);
    font-weight: 800;
    font-size: 14px;
    padding: 10px 10px;
    border-radius: 12px;
    transition: .15s ease;
  }
  .links a:hover{ background: rgba(11,18,32,.06); color: rgba(11,18,32,.92); }

  .header-actions{
    display:flex;
    gap:10px;
    align-items:center;
  }
  .pill{
    display:none;
    font-size: 13px;
    color: rgba(11,18,32,.75);
    font-weight: 800;
    padding: 10px 12px;
    border-radius: 999px;
    border: 1px solid rgba(11,18,32,.12);
    background: rgba(255,255,255,.65);
    white-space:nowrap;
  }

  .btn{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    gap:10px;
    padding: 11px 16px;
    border-radius: 999px;
    font-weight: 900;
    border: 1px solid rgba(11,18,32,.14);
    background: #fff;
    box-shadow: var(--shadow2);
    color: rgba(11,18,32,.92);
    transition: transform .15s ease, box-shadow .15s ease;
    cursor:pointer;
    white-space:nowrap;
  }
  .btn:hover{ transform: translateY(-1px); box-shadow: 0 16px 34px rgba(0,0,0,.12); }
  .btn-primary{
    border: none;
    color:#fff;
    background: linear-gradient(90deg, var(--gradA), var(--gradB));
    box-shadow: 0 18px 44px rgba(255,90,20,.22);
  }

  /* ===== HERO (Safari-safe) =====
     No absolute overlay content anymore.
  */
  .hero-wrap{
    position:relative;
    border-bottom: 1px solid var(--line);
    background:
      linear-gradient(90deg, rgba(255,255,255,.55) 0%, rgba(255,255,255,.18) 45%, rgba(255,255,255,0) 72%),
      linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.12)),
      url("Tremblant.jpg") center/cover no-repeat;
  }
  .hero-inner{
    display:grid;
    grid-template-columns: 1.25fr .75fr;
    align-items: start;
    gap: 22px;
    padding: 26px 0 34px;
    min-height: 520px;
  }
  .hero-left{ padding: 0 18px; }
  .hero-left .container{padding:0}
  .hero-title{
    font-size: clamp(34px, 4vw, 58px);
    line-height: 1.05;
    letter-spacing: -0.6px;
    font-weight: 950;
    color:#0b1220;
    max-width: 18ch;
    margin-top: 24px;
  }
  .hero-sub{
    margin-top: 12px;
    color: rgba(11,18,32,.74);
    font-size: 17px;
    max-width: 68ch;
    font-weight: 700;
  }
  .hero-badges{
    margin-top: 18px;
    display:flex;
    flex-wrap:wrap;
    gap: 10px;
  }
  .badge{
    padding: 9px 12px;
    border-radius: 999px;
    background: rgba(255,255,255,.75);
    border: 1px solid rgba(11,18,32,.10);
    color: rgba(11,18,32,.75);
    font-weight: 900;
    font-size: 13px;
    box-shadow: 0 10px 20px rgba(0,0,0,.06);
  }

  /* ===== Booking widget (step 1 only) ===== */
  .booking-card{
    margin-right: 18px;
    justify-self:end;
    width: min(430px, 100%);
    border-radius: 14px;
    background: #fff;
    box-shadow: 0 28px 70px rgba(0,0,0,.24);
    border: 1px solid rgba(11,18,32,.10);
    overflow:hidden;
  }

  .tabs{
    display:flex;
    background: #fff;
    border-bottom: 1px solid rgba(11,18,32,.08);
  }
  .tab{
    flex:1;
    padding: 14px 14px;
    font-weight: 950;
    font-size: 14px;
    color: rgba(11,18,32,.78);
    background: #fff;
    border:none;
    cursor:pointer;
  }
  .tab.active{
    background: #f4f5f7;
    color: rgba(11,18,32,.94);
  }

  .book-body{ padding: 14px; background: #fff; }

  .stepbar{
    display:flex;
    gap: 8px;
    align-items:center;
    justify-content:space-between;
    margin: 6px 0 12px;
  }
  .stepdot{
    flex: 1;
    height: 6px;
    border-radius: 999px;
    background: rgba(11,18,32,.10);
    overflow:hidden;
    position:relative;
  }
  .stepdot > i{
    position:absolute; inset:0;
    width: 33%;
    background: linear-gradient(90deg, var(--gradA), var(--gradB));
    border-radius: 999px;
  }
  .steptext{
    font-size: 12.5px;
    color: rgba(11,18,32,.65);
    font-weight: 900;
    white-space:nowrap;
    margin-left: 10px;
  }

  .field{
    display:flex;
    align-items:center;
    gap: 10px;
    padding: 12px 12px;
    border-radius: 10px;
    border: 1px solid rgba(11,18,32,.10);
    background: #f4f5f7;
    margin-bottom: 10px;
  }
  .ico{ width: 18px; height: 18px; color: rgba(11,18,32,.55); flex:0 0 auto; }
  .field input, .field select{
    width:100%;
    border:none;
    outline:none;
    background: transparent;
    font-size: 14.5px;
    font-weight: 800;
    color: rgba(11,18,32,.90);
  }
  .field input::placeholder{ color: rgba(11,18,32,.50); font-weight:800; }
  .row2{ display:grid; grid-template-columns: 1fr 1fr; gap: 10px; }
  .note{ margin: 8px 4px 10px; color: rgba(11,18,32,.62); font-size: 12.8px; font-weight: 800; }

  .search-btn{
    width:100%;
    border:none;
    border-radius: 10px;
    padding: 13px 14px;
    font-weight: 950;
    font-size: 15px;
    color: #fff;
    background: linear-gradient(90deg, var(--gradA), var(--gradB));
    cursor:pointer;
    box-shadow: 0 18px 44px rgba(255,90,20,.22);
  }
  .search-btn[disabled]{ opacity:.65; cursor:not-allowed; box-shadow:none; }

  .alert{
    display:none;
    margin-top: 10px;
    padding: 10px 12px;
    border-radius: 12px;
    border: 1px solid rgba(11,18,32,.12);
    background: #fbfbfc;
    font-weight: 850;
    font-size: 13px;
  }
  .alert.bad{ border-color: rgba(176,0,32,.25); background: rgba(176,0,32,.06); color: var(--bad); }
  .alert.good{ border-color: rgba(15,157,88,.22); background: rgba(15,157,88,.06); color: var(--good); }

  /* ===== ‚ÄúBlacklane-like‚Äù full-screen pages (Step 2 + Step 3) ===== */
  .overlay{
    position: fixed;
    inset: 0;
    z-index: 999;
    background: rgba(255,255,255,.96);
    display: none;
    overflow: hidden;
  }
  .overlay.show{ display: block; }

  .overlay-top{
    height: 76px;
    border-bottom: 1px solid rgba(11,18,32,.10);
    background: rgba(255,255,255,.92);
    backdrop-filter: blur(10px);
    display:flex;
    align-items:center;
  }
  .overlay-top .container{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap: 12px;
    width: 100%;
  }
  .overlay-title{
    font-weight: 950;
    letter-spacing: .2px;
  }
  .overlay-close{
    border: 1px solid rgba(11,18,32,.14);
    background: #fff;
    border-radius: 12px;
    padding: 10px 12px;
    font-weight: 900;
    cursor: pointer;
  }

  .overlay-body{
    height: calc(100vh - 76px);
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    padding: 26px 0 40px;
  }

  .flow-wrap{
    max-width: 760px;
    margin: 0 auto;
    padding: 0 18px;
  }

  .flow-steps{
    display:flex;
    gap: 18px;
    align-items:center;
    justify-content:center;
    color: rgba(11,18,32,.55);
    font-weight: 900;
    font-size: 13px;
    margin-bottom: 14px;
  }
  .flow-steps .on{ color: rgba(11,18,32,.92); }

  .summary-pill{
    border: 1px solid rgba(11,18,32,.12);
    border-radius: 16px;
    background: #fbfbfc;
    padding: 14px 16px;
    font-weight: 800;
    color: rgba(11,18,32,.82);
  }
  .summary-pill small{
    display:block;
    color: rgba(11,18,32,.62);
    font-weight: 800;
    margin-top: 4px;
  }

  .flow-h1{
    margin-top: 18px;
    font-size: 28px;
    line-height: 1.15;
    letter-spacing: -.2px;
    font-weight: 950;
  }
  .flow-sub{
    margin-top: 8px;
    color: rgba(11,18,32,.66);
    font-weight: 750;
  }

  .vlist{
    margin-top: 16px;
    border: 1px solid rgba(11,18,32,.12);
    border-radius: 16px;
    overflow: hidden;
    background: #fff;
  }
  .vrow{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap: 14px;
    padding: 14px 14px;
    border-top: 1px solid rgba(11,18,32,.10);
    cursor: pointer;
  }
  .vrow:first-child{ border-top: none; }
  .vrow:hover{ background: rgba(11,18,32,.03); }
  .vrow.selected{ outline: 2px solid rgba(255,90,20,.35); background: rgba(255,90,20,.06); }

  .vleft b{ display:block; font-weight: 950; }
  .vleft small{ display:block; margin-top: 2px; color: rgba(11,18,32,.62); font-weight: 800; }
  .vright{
    text-align:right;
    font-weight: 950;
    white-space: nowrap;
  }

  .flow-actions{
    margin-top: 18px;
    display:flex;
    gap: 12px;
    justify-content: space-between;
    flex-wrap: wrap;
  }
  .flow-actions .btn{
    border-radius: 14px;
    padding: 12px 14px;
    box-shadow:none;
  }
  .flow-actions .btn-primary{
    box-shadow: 0 16px 34px rgba(255,90,20,.18);
  }
  .btn:disabled{ opacity:.55; cursor:not-allowed; }

  /* Reserve form section */
  .section{ margin-top: 46px; }
  h2{ font-size: 30px; letter-spacing: -.2px; line-height:1.15; }
  .subtitle{
    margin-top: 10px;
    color: rgba(11,18,32,.66);
    font-weight: 700;
    max-width: 920px;
  }

  .grid3{
    margin-top: 16px;
    display:grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 14px;
  }
  .grid2{
    margin-top: 16px;
    display:grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 14px;
  }
  .card{
    border-radius: var(--radius);
    border: 1px solid rgba(11,18,32,.10);
    background: #fff;
    box-shadow: 0 14px 36px rgba(0,0,0,.08);
    overflow:hidden;
  }
  .card-media img{width:100%;aspect-ratio: 16/10;object-fit:cover;display:block}
  .card-body{padding: 14px}
  .card-body h3{ font-size: 17px; letter-spacing: -.1px; }
  .meta{ margin-top: 6px; color: rgba(11,18,32,.66); font-weight:700; font-size: 13.5px; }
  .price{ margin-top: 10px; font-weight: 950; }
  .min{ margin-top: 3px; color: rgba(11,18,32,.58); font-weight: 800; font-size: 12.5px; }
  .actions{ margin-top: 12px; display:flex; gap:10px; flex-wrap:wrap; }
  .actions .btn{ box-shadow:none; }

  .book-wrap{
    margin-top: 16px;
    border-radius: 18px;
    border: 1px solid rgba(11,18,32,.10);
    background: #fff;
    box-shadow: 0 18px 55px rgba(0,0,0,.10);
    overflow:hidden;
  }
  .book-head{
    padding: 16px 18px;
    border-bottom: 1px solid rgba(11,18,32,.08);
    background: #fbfbfc;
  }
  .book-head b{display:block;font-size:15px;font-weight:950}
  .book-head small{display:block;margin-top:6px;color:rgba(11,18,32,.64);font-weight:700}
  .book-body2{padding: 16px 18px 18px}

  label{
    display:block;
    margin: 12px 0 6px;
    font-size: 12.5px;
    font-weight: 900;
    color: rgba(11,18,32,.74);
    letter-spacing: .18px;
  }
  input, select, textarea{
    width:100%;
    padding: 12px 12px;
    border-radius: 12px;
    border: 1px solid rgba(11,18,32,.14);
    background: #f4f5f7;
    color: rgba(11,18,32,.92);
    outline:none;
    font-weight: 800;
  }
  textarea{min-height: 92px; resize: vertical}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .tinyhint{margin-top:6px;font-size:12.5px;color:rgba(11,18,32,.62);font-weight:700}
  input:focus, select:focus, textarea:focus{ border-color: rgba(255,90,20,.65); box-shadow: 0 0 0 4px rgba(255,90,20,.12); }

  .estimate-box{
    margin-top: 12px;
    border-radius: 12px;
    border: 1px solid rgba(11,18,32,.12);
    background: #fbfbfc;
    padding: 12px;
  }
  .estimate-top{display:flex;justify-content:space-between;gap:10px;align-items:center;flex-wrap:wrap}
  .estimate-top b{font-size:13.5px}
  .estimate-value{font-weight:950}
  .estimate-sub{margin-top:6px;color:rgba(11,18,32,.68);font-size:12.8px;font-weight:700}
  .book-actions{margin-top: 12px; display:flex; gap: 10px; flex-wrap:wrap;}

  footer{
    margin-top: 64px;
    padding: 26px 0;
    text-align:center;
    color: rgba(11,18,32,.62);
    border-top: 1px solid rgba(11,18,32,.10);
    font-weight: 700;
  }

  .whatsapp-float{
    position:fixed;
    right: 96px;
    bottom: 16px;
    background:#25D366;
    color:#0b0b0b;
    padding: 12px 16px;
    border-radius: 999px;
    font-weight: 950;
    box-shadow: 0 16px 38px rgba(0,0,0,.16);
    z-index:60;
    border: 1px solid rgba(0,0,0,.14);
  }
  @media (max-width: 520px){
    .whatsapp-float{ right: 16px; bottom: 96px; }
  }

  @media (max-width: 980px){
    .hero-inner{ grid-template-columns: 1fr; }
    .booking-card{ justify-self:stretch; margin: 14px 18px 0; width:auto; }
    .grid3{ grid-template-columns: 1fr; }
    .grid2{ grid-template-columns: 1fr; }
    .row{ grid-template-columns: 1fr; }
    .row2{ grid-template-columns: 1fr; }
  }
  @media (max-width: 860px){
    .links{ display:none; }
    .pill{ display:inline-flex; }
    .header-actions .btn{ display:none; }
  }

</style>
</head>

<body>

<header>
  <div class="container">
    <div class="nav">
      <div class="brand">
        <div class="logo">MT</div>
        <div>Mont Tremblant Limo</div>
      </div>

      <div class="links">
        <a href="#fleet">Our fleet</a>
        <a href="#routes">Destinations</a>
        <a href="#faq">FAQ</a>
        <a href="#contact">Book</a>
      </div>

      <div class="header-actions">
        <span class="pill">üìû <a href="tel:+15142933170">+1 (514) 293-3170</a></span>
        <a class="btn" href="https://wa.me/15142933170" target="_blank" rel="noreferrer">WhatsApp</a>
        <a class="btn btn-primary" href="#contact">Book now</a>
      </div>
    </div>
  </div>
</header>

<!-- HERO -->
<div class="hero-wrap">
  <div class="hero-inner container">
    <div class="hero-left">
      <div class="hero-title">Luxury chauffeur service in Mont-Tremblant</div>
      <div class="hero-sub">
        Airport transfers, hourly bookings, ski trips, corporate travel and special events.
        <b>Minimum 3 hours on all vehicles.</b>
      </div>
      <div class="hero-badges">
        <span class="badge">24/7 booking</span>
        <span class="badge">Professional chauffeurs</span>
        <span class="badge">Premium vehicles</span>
        <span class="badge">Mont-Tremblant ‚Ä¢ Montr√©al ‚Ä¢ Ottawa</span>
      </div>
    </div>

    <!-- STEP 1 -->
    <aside class="booking-card" aria-label="Search booking">
      <div class="tabs">
        <button id="tabOneWay" class="tab active" type="button" aria-selected="true">One way</button>
        <button id="tabHourly" class="tab" type="button" aria-selected="false">By the hour</button>
      </div>

      <div class="book-body">
        <div class="stepbar" aria-hidden="true">
          <div class="stepdot"><i></i></div>
          <div class="steptext">Step 1 of 3</div>
        </div>

        <form id="heroSearchForm">
          <input type="hidden" id="heroMode" value="one_way" />

          <div class="field">
            <svg class="ico" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M12 21s7-6 7-11a7 7 0 1 0-14 0c0 5 7 11 7 11Z" stroke="currentColor" stroke-width="2"/>
              <path d="M12 10.5a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z" stroke="currentColor" stroke-width="2"/>
            </svg>
            <input id="h_pickup" placeholder="From: address, airport, hotel‚Ä¶" autocomplete="off" required />
          </div>

          <div id="heroDropoffWrap" class="field">
            <svg class="ico" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M12 21s7-6 7-11a7 7 0 1 0-14 0c0 5 7 11 7 11Z" stroke="currentColor" stroke-width="2"/>
              <path d="M12 10.5a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z" stroke="currentColor" stroke-width="2"/>
            </svg>
            <input id="h_dropoff" placeholder="To: address, airport, hotel‚Ä¶" autocomplete="off" required />
          </div>

          <div class="row2">
            <div class="field">
              <svg class="ico" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M7 2v3M17 2v3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path d="M3 9h18" stroke="currentColor" stroke-width="2"/>
                <path d="M5 5h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2Z" stroke="currentColor" stroke-width="2"/>
              </svg>
              <input id="h_date" type="date" required />
            </div>

            <div class="field">
              <svg class="ico" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M12 8v5l3 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path d="M12 22a10 10 0 1 0 0-20 10 10 0 0 0 0 20Z" stroke="currentColor" stroke-width="2"/>
              </svg>
              <select id="h_time" required></select>
            </div>
          </div>

          <div id="heroTransferWrap" class="field" style="margin-top:10px">
            <svg class="ico" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M3 11h18M6 11V7a3 3 0 0 1 3-3h6a3 3 0 0 1 3 3v4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              <path d="M7 20a2 2 0 1 0 0-4 2 2 0 0 0 0 4ZM17 20a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z" stroke="currentColor" stroke-width="2"/>
            </svg>
            <select id="h_transfer">
              <option value="point" selected>City / Point-to-point</option>
              <option value="airport">Airport transfer</option>
            </select>
          </div>

          <div id="heroHoursWrap" class="field" style="display:none; margin-top:10px">
            <svg class="ico" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M12 8v5l3 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              <path d="M12 22a10 10 0 1 0 0-20 10 10 0 0 0 0 20Z" stroke="currentColor" stroke-width="2"/>
            </svg>
            <select id="h_hours">
              <option value="3">3 hours (minimum)</option>
              <option value="4">4 hours</option>
              <option value="5">5 hours</option>
              <option value="6">6 hours</option>
              <option value="8">8 hours</option>
            </select>
          </div>

          <div class="note">Professional chauffeur ‚Ä¢ clean premium vehicles.</div>

          <button id="heroSearchBtn" class="search-btn" type="submit">Search</button>
          <div id="heroAlert" class="alert bad"></div>
        </form>
      </div>
    </aside>
  </div>
</div>

<!-- STEP 2 OVERLAY (Vehicle selection) -->
<div id="overlayVehicles" class="overlay" aria-hidden="true">
  <div class="overlay-top">
    <div class="container">
      <div class="overlay-title">Mont Tremblant Limo ‚Ä¢ Booking</div>
      <button class="overlay-close" type="button" onclick="closeOverlay('overlayVehicles')">Close</button>
    </div>
  </div>
  <div class="overlay-body">
    <div class="flow-wrap">
      <div class="flow-steps">
        <span>Search</span> <span>‚Ä∫</span>
        <span class="on">Service Class</span> <span>‚Ä∫</span>
        <span>Checkout</span>
      </div>

      <div class="summary-pill" id="tripSummary"></div>

      <div class="flow-h1">Select a vehicle</div>
      <div class="flow-sub">Prices shown are estimates. Minimum 3 hours applies.</div>

      <div class="vlist" id="vehicleOverlayList"></div>

      <div class="flow-actions">
        <button class="btn" type="button" onclick="backToSearch()">Edit search</button>
        <button id="btnVehicleContinue" class="btn btn-primary" type="button" disabled onclick="goToCheckoutOverlay()">Continue</button>
      </div>
    </div>
  </div>
</div>

<!-- STEP 3 OVERLAY (Checkout / Pay) -->
<div id="overlayCheckout" class="overlay" aria-hidden="true">
  <div class="overlay-top">
    <div class="container">
      <div class="overlay-title">Mont Tremblant Limo ‚Ä¢ Checkout</div>
      <button class="overlay-close" type="button" onclick="closeOverlay('overlayCheckout')">Close</button>
    </div>
  </div>
  <div class="overlay-body">
    <div class="flow-wrap">
      <div class="flow-steps">
        <span>Search</span> <span>‚Ä∫</span>
        <span>Service Class</span> <span>‚Ä∫</span>
        <span class="on">Checkout</span>
      </div>

      <div class="summary-pill" id="checkoutSummary"></div>

      <div class="flow-h1">Your details</div>
      <div class="flow-sub">Enter your name and phone, then pay securely via Stripe.</div>

      <label for="c_name">Name</label>
      <input id="c_name" placeholder="Your name" />

      <label for="c_phone">Phone</label>
      <input id="c_phone" placeholder="+1 ..." />

      <label for="c_notes">Notes (optional)</label>
      <textarea id="c_notes" placeholder="Passengers, luggage, flight #, stops‚Ä¶"></textarea>

      <div class="estimate-box" style="margin-top:14px;">
        <div class="estimate-top">
          <b>Total estimate</b>
          <div class="estimate-value" id="checkoutTotal">‚Äî</div>
        </div>
        <div class="estimate-sub" id="checkoutSub">Minimum 3 hours applies.</div>
      </div>

      <div class="flow-actions" style="margin-top:14px;">
        <button class="btn" type="button" onclick="backToVehicles()">Back</button>
        <button class="btn btn-primary" type="button" onclick="startStripeCheckoutFromOverlay()">Pay with Stripe</button>
        <button class="btn" type="button" onclick="sendWhatsAppFromOverlay()">WhatsApp</button>
      </div>

      <div class="tinyhint" id="checkoutStatus" style="margin-top:10px;"></div>
    </div>
  </div>
</div>

<main class="container">
  <section id="fleet" class="section">
    <h2>Our Fleet</h2>
    <p class="subtitle">Premium vehicles for Mont-Tremblant travel. <b>Minimum 3 hours</b> applies to all vehicles.</p>

    <div class="grid3">
      <div class="card">
        <div class="card-media"><img src="escalade.jpg" alt="2026 Cadillac Escalade ESV black"></div>
        <div class="card-body">
          <h3>2026 Cadillac Escalade ESV</h3>
          <div class="meta">Ultra-luxury ‚Ä¢ VIP airport transfers ‚Ä¢ ski trips</div>
          <div class="price">$150 / hour</div>
          <div class="min">3-hour minimum</div>
          <div class="actions">
            <a class="btn btn-primary" href="#contact">Reserve</a>
            <a class="btn" href="https://wa.me/15142933170" target="_blank" rel="noreferrer">WhatsApp</a>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-media"><img src="suburban.jpg" alt="2025 Chevrolet Suburban black"></div>
        <div class="card-body">
          <h3>2025 Chevrolet Suburban</h3>
          <div class="meta">Spacious ‚Ä¢ luggage friendly ‚Ä¢ long rides</div>
          <div class="price">$120 / hour</div>
          <div class="min">3-hour minimum</div>
          <div class="actions">
            <a class="btn btn-primary" href="#contact">Reserve</a>
            <a class="btn" href="https://wa.me/15142933170" target="_blank" rel="noreferrer">WhatsApp</a>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-media"><img src="denali.jpg" alt="2026 GMC Yukon Denali black"></div>
        <div class="card-body">
          <h3>2026 GMC Yukon Denali</h3>
          <div class="meta">Premium comfort ‚Ä¢ smooth ride ‚Ä¢ executive travel</div>
          <div class="price">$120 / hour</div>
          <div class="min">3-hour minimum</div>
          <div class="actions">
            <a class="btn btn-primary" href="#contact">Reserve</a>
            <a class="btn" href="https://wa.me/15142933170" target="_blank" rel="noreferrer">WhatsApp</a>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-media"><img src="qx60.jpg" alt="2024 Infiniti QX60 black"></div>
        <div class="card-body">
          <h3>2024 Infiniti QX60</h3>
          <div class="meta">Comfort + value ‚Ä¢ airport transfers ‚Ä¢ city rides</div>
          <div class="price">$99 / hour</div>
          <div class="min">3-hour minimum</div>
          <div class="actions">
            <a class="btn btn-primary" href="#contact">Reserve</a>
            <a class="btn" href="https://wa.me/15142933170" target="_blank" rel="noreferrer">WhatsApp</a>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-media"><img src="tesla.jpg" alt="2023 Tesla Model Y black"></div>
        <div class="card-body">
          <h3>2023 Tesla Model Y</h3>
          <div class="meta">Quiet ‚Ä¢ modern ‚Ä¢ eco-friendly</div>
          <div class="price">$75 / hour</div>
          <div class="min">3-hour minimum</div>
          <div class="actions">
            <a class="btn btn-primary" href="#contact">Reserve</a>
            <a class="btn" href="https://wa.me/15142933170" target="_blank" rel="noreferrer">WhatsApp</a>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-media"><img src="sprinter.jpg" alt="Black Mercedes Sprinter van"></div>
        <div class="card-body">
          <h3>Mercedes Sprinter (Group Van)</h3>
          <div class="meta">Groups ‚Ä¢ events ‚Ä¢ ski luggage</div>
          <div class="price">$250 / hour</div>
          <div class="min">3-hour minimum</div>
          <div class="actions">
            <a class="btn btn-primary" href="#contact">Reserve</a>
            <a class="btn" href="https://wa.me/15142933170" target="_blank" rel="noreferrer">WhatsApp</a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section id="contact" class="section">
    <h2>Reserve</h2>
    <p class="subtitle">You can also book by WhatsApp. Stripe checkout requires your backend endpoint.</p>

    <div class="book-wrap">
      <div class="book-head">
        <b>Reserve Now</b>
        <small>If you use the search above, this form gets prefilled automatically.</small>
      </div>

      <div class="book-body2">
        <form onsubmit="return false;">
          <div class="row">
            <div>
              <label for="name">Name</label>
              <input id="name" placeholder="Your name" />
            </div>
            <div>
              <label for="phone">Phone</label>
              <input id="phone" placeholder="+1 ..." />
            </div>
          </div>

          <div class="row">
            <div>
              <label for="date">Date</label>
              <input id="date" type="date" />
            </div>
            <div>
              <label for="time">Time</label>
              <select id="time"></select>
            </div>
          </div>

          <div class="row">
            <div>
              <label for="pickup">Pickup</label>
              <input id="pickup" placeholder="Hotel / Airport / Address" autocomplete="off" />
            </div>
            <div>
              <label for="dropoff">Drop-off</label>
              <input id="dropoff" placeholder="Destination" autocomplete="off" />
            </div>
          </div>

          <div class="row">
            <div>
              <label for="triptype">Trip type</label>
              <select id="triptype">
                <option value="hourly" selected>Hourly (3-hour minimum)</option>
                <option value="point">Point-to-point</option>
                <option value="airport">Airport transfer</option>
              </select>
            </div>
            <div>
              <label for="vehicle">Vehicle</label>
              <select id="vehicle"></select>
            </div>
          </div>

          <div class="estimate-box">
            <div class="estimate-top">
              <b>Estimated total</b>
              <div class="estimate-value" id="estimateValue">‚Äî</div>
            </div>
            <div class="estimate-sub" id="estimateSub">Use the search widget above.</div>
          </div>

          <div class="book-actions">
            <button class="btn btn-primary" type="button" onclick="startStripeCheckoutFromForm()">Pay with Stripe</button>
            <button class="btn" type="button" onclick="sendWhatsAppFromForm()">Send WhatsApp</button>
            <a class="btn" href="tel:+15142933170">Call</a>
          </div>
        </form>
      </div>
    </div>
  </section>

  <section id="routes" class="section">
    <h2>Destinations</h2>
    <p class="subtitle">Common trips. Long-distance routes and stops can be adjusted by message.</p>
    <div class="grid2">
      <div class="card"><div class="card-body"><h3>Montr√©al (YUL) ‚Üî Mont-Tremblant</h3><div class="meta">Airport pickups ‚Ä¢ ski luggage ‚Ä¢ hotel drops</div></div></div>
      <div class="card"><div class="card-body"><h3>Montr√©al Downtown ‚Üî Mont-Tremblant</h3><div class="meta">Business travel ‚Ä¢ weekends ‚Ä¢ events</div></div></div>
      <div class="card"><div class="card-body"><h3>Qu√©bec City ‚Üî Mont-Tremblant</h3><div class="meta">Private long-distance ‚Ä¢ comfort ride</div></div></div>
      <div class="card"><div class="card-body"><h3>Ottawa ‚Üî Mont-Tremblant</h3><div class="meta">Long-distance comfort ‚Ä¢ family trips</div></div></div>
    </div>
  </section>

  <section id="faq" class="section">
    <h2>FAQ</h2>
    <p class="subtitle">Quick answers to the most common questions.</p>
    <div class="card" style="padding: 0 18px;">
      <details>
        <summary style="cursor:pointer; list-style:none; font-weight:900; padding:14px 0;">What is the minimum booking time?</summary>
        <p style="padding-bottom:14px;color:rgba(11,18,32,.70);font-weight:700;">All vehicles have a <b>3-hour minimum</b>.</p>
      </details>
    </div>
  </section>

  <footer>
    ¬© <span id="year"></span> Mont Tremblant Limo Services ‚Ä¢ All rights reserved
  </footer>
</main>

<a class="whatsapp-float" href="https://wa.me/15142933170" target="_blank" rel="noreferrer">WhatsApp</a>

<script>
  document.getElementById("year").textContent = new Date().getFullYear();

  // =========================
  // ‚úÖ SIMPLE LOCAL PRICING ONLY (no API)
  // =========================
  const BUSINESS_WA = "15142933170";

  const LOCAL_RATES = [
    { id:"escalade", name:"2026 Cadillac Escalade ESV", hourly:150, meta:"Ultra-luxury ‚Ä¢ VIP airport transfers ‚Ä¢ ski trips" },
    { id:"suburban", name:"2025 Chevrolet Suburban", hourly:120, meta:"Spacious ‚Ä¢ luggage friendly ‚Ä¢ long rides" },
    { id:"denali", name:"2026 GMC Yukon Denali", hourly:120, meta:"Premium comfort ‚Ä¢ smooth ride ‚Ä¢ executive travel" },
    { id:"qx60", name:"2024 Infiniti QX60", hourly:99, meta:"Comfort + value ‚Ä¢ airport transfers ‚Ä¢ city rides" },
    { id:"tesla", name:"2023 Tesla Model Y", hourly:75, meta:"Quiet ‚Ä¢ modern ‚Ä¢ eco-friendly" },
    { id:"sprinter", name:"Mercedes Sprinter (Group Van)", hourly:250, meta:"Groups ‚Ä¢ events ‚Ä¢ ski luggage" }
  ];

  const state = {
    mode: "one_way", // one_way | hourly
    pickup: "",
    dropoff: "",
    date: "",
    time: "",
    transfer: "point", // point|airport
    hours: 3,
    selectedVehicleId: null,
    computedVehicles: []
  };

  function $(id){ return document.getElementById(id); }
  function val(id){ return ($(id)?.value || "").trim(); }

  function formatMoney(n){
    if (!Number.isFinite(Number(n))) return "‚Äî";
    return new Intl.NumberFormat("en-CA", { style:"currency", currency:"CAD", maximumFractionDigits:0 }).format(Number(n));
  }

  function buildTimeOptions(stepMinutes = 5, selectId = "time"){
    const timeEl = document.getElementById(selectId);
    if (!timeEl || timeEl.tagName !== "SELECT") return;

    timeEl.innerHTML = "";
    const ph = document.createElement("option");
    ph.value = "";
    ph.textContent = "Select time";
    ph.selected = true;
    ph.disabled = true;
    timeEl.appendChild(ph);

    const pad = (n)=> String(n).padStart(2,"0");
    for (let minutes = 0; minutes < 24 * 60; minutes += stepMinutes){
      const hh = Math.floor(minutes / 60);
      const mm = minutes % 60;
      const value = `${pad(hh)}:${pad(mm)}`;
      const hour12 = ((hh + 11) % 12) + 1;
      const ampm = hh < 12 ? "AM" : "PM";
      const label = `${hour12}:${pad(mm)} ${ampm}`;
      const opt = document.createElement("option");
      opt.value = value;
      opt.textContent = label;
      timeEl.appendChild(opt);
    }

    const now = new Date();
    let mins = now.getHours() * 60 + now.getMinutes();
    mins = Math.ceil(mins / stepMinutes) * stepMinutes;
    if (mins >= 24*60) mins = 0;
    const hh = Math.floor(mins / 60);
    const mm = mins % 60;
    timeEl.value = `${pad(hh)}:${pad(mm)}`;
  }

  function setHeroMode(mode){
    state.mode = mode;
    $("heroMode").value = mode;

    const one = mode === "one_way";
    $("tabOneWay").classList.toggle("active", one);
    $("tabHourly").classList.toggle("active", !one);

    $("heroDropoffWrap").style.display = one ? "" : "none";
    $("heroTransferWrap").style.display = one ? "" : "none";
    $("heroHoursWrap").style.display = one ? "none" : "";

    $("h_dropoff").required = one;
  }

  function showHeroAlert(message){
    const el = $("heroAlert");
    el.style.display = "block";
    el.textContent = message;
  }
  function clearHeroAlert(){
    const el = $("heroAlert");
    el.style.display = "none";
    el.textContent = "";
  }

  function validateHero(){
    if (!val("h_pickup")) return "Please enter a pickup location.";
    if (state.mode === "one_way" && !val("h_dropoff")) return "Please enter a destination.";
    if (!$("h_date").value) return "Please choose a date.";
    if (!val("h_time")) return "Please choose a time.";
    return null;
  }

  function calcVehicleTotal(vehicle){
    const h = Math.max(3, Number(state.hours || 3));
    if (state.mode === "hourly") {
      return vehicle.hourly * h;
    }
    // one_way estimate: 3h minimum + small fee
    const fee = state.transfer === "airport" ? 60 : 40;
    return (vehicle.hourly * 3) + fee;
  }

  function buildVehiclesForTrip(){
    const list = LOCAL_RATES.map(v=>{
      const total = calcVehicleTotal(v);
      const note = state.mode === "hourly"
        ? `Estimated for ${Math.max(3, Number(state.hours||3))}h (min 3h)`
        : (state.transfer === "airport" ? "Airport estimate (3h min + fee)" : "Point-to-point estimate (3h min + fee)");
      return { ...v, total, note };
    });

    // sort cheapest first like marketplace
    list.sort((a,b)=>a.total - b.total);
    return list;
  }

  function openOverlay(id){
    document.body.style.overflow = "hidden";
    const el = $(id);
    el.classList.add("show");
    el.setAttribute("aria-hidden","false");
  }
  function closeOverlay(id){
    const el = $(id);
    el.classList.remove("show");
    el.setAttribute("aria-hidden","true");
    document.body.style.overflow = "";
  }

  function backToSearch(){
    closeOverlay("overlayVehicles");
  }
  function backToVehicles(){
    closeOverlay("overlayCheckout");
    openOverlay("overlayVehicles");
  }

  function renderTripSummary(){
    const when = `${state.date} at ${state.time}`;
    const route = state.mode === "hourly"
      ? `${state.pickup} ‚Üí Hourly (Mont-Tremblant area)`
      : `${state.pickup} ‚Üí ${state.dropoff}`;

    $("tripSummary").innerHTML = `
      <div><b>${when}</b></div>
      <small>${route}</small>
    `;
  }

  function renderVehiclesOverlay(){
    const wrap = $("vehicleOverlayList");
    wrap.innerHTML = "";
    state.selectedVehicleId = null;
    $("btnVehicleContinue").disabled = true;

    state.computedVehicles.forEach(v=>{
      const row = document.createElement("div");
      row.className = "vrow";
      row.innerHTML = `
        <div class="vleft">
          <b>${v.name}</b>
          <small>${v.note}</small>
        </div>
        <div class="vright">${formatMoney(v.total)}</div>
      `;
      row.addEventListener("click", ()=>{
        document.querySelectorAll(".vrow").forEach(x=>x.classList.remove("selected"));
        row.classList.add("selected");
        state.selectedVehicleId = v.id;
        $("btnVehicleContinue").disabled = false;
      });
      wrap.appendChild(row);
    });
  }

  function goToCheckoutOverlay(){
    if (!state.selectedVehicleId) return;
    closeOverlay("overlayVehicles");

    const chosen = state.computedVehicles.find(v=>v.id === state.selectedVehicleId);
    const when = `${state.date} at ${state.time}`;
    const route = state.mode === "hourly"
      ? `${state.pickup} ‚Üí Hourly (Mont-Tremblant area)`
      : `${state.pickup} ‚Üí ${state.dropoff}`;

    $("checkoutSummary").innerHTML = `
      <div><b>${when}</b></div>
      <small>${route} ‚Ä¢ ${chosen?.name || ""}</small>
    `;

    $("checkoutTotal").textContent = chosen ? formatMoney(chosen.total) : "‚Äî";
    $("checkoutSub").textContent = chosen ? chosen.note : "";

    // Prefill bottom form too (optional)
    prefillBottomFormFromState();

    openOverlay("overlayCheckout");
  }

  function prefillBottomFormFromState(){
    $("pickup").value = state.pickup;
    $("dropoff").value = state.mode === "hourly" ? "Mont-Tremblant (area)" : state.dropoff;
    $("date").value = state.date;
    $("time").value = state.time;

    // triptype mapping
    $("triptype").value = (state.mode === "hourly") ? "hourly" : (state.transfer === "airport" ? "airport" : "point");

    // vehicle dropdown
    const vehicleSel = $("vehicle");
    vehicleSel.innerHTML = "";
    const ph = document.createElement("option");
    ph.value = "";
    ph.textContent = "Select vehicle";
    ph.selected = true;
    vehicleSel.appendChild(ph);

    state.computedVehicles.forEach(v=>{
      const opt = document.createElement("option");
      opt.value = v.name;
      opt.textContent = `${v.name} ‚Äî ${formatMoney(v.total)}`;
      opt.dataset.vehicleId = v.id;
      opt.dataset.total = String(v.total);
      vehicleSel.appendChild(opt);
    });

    const chosen = state.computedVehicles.find(v=>v.id === state.selectedVehicleId);
    if (chosen) vehicleSel.value = chosen.name;

    // estimate display
    if (chosen){
      $("estimateValue").textContent = formatMoney(chosen.total);
      $("estimateSub").textContent = chosen.note;
    } else {
      $("estimateValue").textContent = "‚Äî";
      $("estimateSub").textContent = "Use the search widget above.";
    }
  }

  // =========================
  // Stripe + WhatsApp (overlay)
  // =========================
  function getChosenVehicle(){
    return state.computedVehicles.find(v=>v.id === state.selectedVehicleId) || null;
  }

  function buildWhatsAppMessage(payload){
    const lines = [];
    lines.push("Booking Request - Mont Tremblant Limo Services");
    lines.push(`Name: ${payload.name || ""}`);
    if (payload.phone) lines.push(`Phone: ${payload.phone}`);
    lines.push(`Date: ${payload.date}`);
    lines.push(`Time: ${payload.time}`);
    lines.push(`Pickup: ${payload.pickup}`);
    lines.push(`Drop-off: ${payload.dropoff}`);
    lines.push(`Trip type: ${payload.triptype}`);
    lines.push(`Vehicle: ${payload.vehicle}`);
    lines.push(`Estimate: ${payload.estimate_text}`);
    if (payload.notes) lines.push(`Notes: ${payload.notes}`);
    return encodeURIComponent(lines.join("\n"));
  }

  function sendWhatsAppFromOverlay(){
    const chosen = getChosenVehicle();
    if (!chosen) return;

    const name = val("c_name");
    const phone = val("c_phone");
    const notes = val("c_notes");

    const triptype = (state.mode === "hourly") ? "Hourly" : (state.transfer === "airport" ? "Airport transfer" : "Point-to-point");
    const payload = {
      name, phone,
      date: state.date,
      time: state.time,
      pickup: state.pickup,
      dropoff: (state.mode === "hourly") ? "Mont-Tremblant (area)" : state.dropoff,
      triptype,
      vehicle: chosen.name,
      estimate_text: `${formatMoney(chosen.total)} (${chosen.note})`,
      notes
    };

    window.open("https://wa.me/" + BUSINESS_WA + "?text=" + buildWhatsAppMessage(payload), "_blank", "noreferrer");
  }

  async function startStripeCheckoutFromOverlay(){
    const statusEl = $("checkoutStatus");
    statusEl.textContent = "";

    const chosen = getChosenVehicle();
    if (!chosen){
      statusEl.textContent = "Please choose a vehicle first.";
      return;
    }

    const name = val("c_name");
    if (!name){
      statusEl.textContent = "Please enter your name.";
      return;
    }

    const booking = {
      name: name,
      phone: val("c_phone"),
      date: state.date,
      time: state.time,
      pickup: state.pickup,
      dropoff: (state.mode === "hourly") ? "Mont-Tremblant (area)" : state.dropoff,
      triptype: (state.mode === "hourly") ? "hourly" : (state.transfer === "airport" ? "airport" : "point"),
      vehicle: chosen.name,
      vehicle_id: chosen.id,
      hours: String(Math.max(3, Number(state.hours||3))),
      roundtrip: "no",
      notes: val("c_notes"),
      estimate_text: `${formatMoney(chosen.total)} (${chosen.note})`,
      estimate_total_cad: chosen.total,
      pay_option: "full",
      pay_now_cad: chosen.total
    };

    try{
      statusEl.textContent = "Starting secure checkout‚Ä¶";
      const res = await fetch("/api/create-checkout-session", {
        method: "POST",
        headers: { "Content-Type":"application/json" },
        body: JSON.stringify(booking)
      });
      const data = await res.json().catch(()=> ({}));
      if (!res.ok) throw new Error(data?.error || "Unable to start checkout.");
      if (!data?.url) throw new Error("Missing checkout URL from server.");
      window.location.href = data.url;
    }catch(err){
      console.error(err);
      statusEl.textContent = "Stripe checkout error: " + (err.message || "Unknown error");
      alert("Stripe checkout error: " + (err.message || "Unknown error"));
    }
  }

  // =========================
  // Bottom form quick buttons (optional)
  // =========================
  function sendWhatsAppFromForm(){
    const vehicleSel = $("vehicle");
    const opt = vehicleSel?.options?.[vehicleSel.selectedIndex];
    const total = Number(opt?.dataset?.total);
    const totalText = Number.isFinite(total) ? formatMoney(total) : "‚Äî";

    const payload = {
      name: val("name"),
      phone: val("phone"),
      date: val("date"),
      time: val("time"),
      pickup: val("pickup"),
      dropoff: val("dropoff"),
      triptype: val("triptype"),
      vehicle: val("vehicle"),
      estimate_text: totalText,
      notes: ""
    };
    window.open("https://wa.me/" + BUSINESS_WA + "?text=" + buildWhatsAppMessage(payload), "_blank", "noreferrer");
  }

  async function startStripeCheckoutFromForm(){
    const vehicleSel = $("vehicle");
    const opt = vehicleSel?.options?.[vehicleSel.selectedIndex];
    const total = Number(opt?.dataset?.total);

    if (!val("name")) return alert("Please enter your name.");
    if (!val("date") || !val("time") || !val("pickup") || !val("dropoff") || !val("vehicle")) {
      return alert("Please complete the form and choose a vehicle.");
    }
    if (!Number.isFinite(total)) return alert("Please use the Search widget to generate vehicle totals.");

    const booking = {
      name: val("name"),
      phone: val("phone"),
      date: val("date"),
      time: val("time"),
      pickup: val("pickup"),
      dropoff: val("dropoff"),
      triptype: val("triptype"),
      vehicle: val("vehicle"),
      vehicle_id: opt?.dataset?.vehicleId || null,
      hours: String(Math.max(3, Number(state.hours||3))),
      roundtrip: "no",
      notes: "",
      estimate_text: total.toString(),
      estimate_total_cad: total,
      pay_option: "full",
      pay_now_cad: total
    };

    try{
      const res = await fetch("/api/create-checkout-session", {
        method: "POST",
        headers: { "Content-Type":"application/json" },
        body: JSON.stringify(booking)
      });
      const data = await res.json().catch(()=> ({}));
      if (!res.ok) throw new Error(data?.error || "Unable to start checkout.");
      window.location.href = data.url;
    }catch(err){
      alert("Stripe checkout error: " + (err.message || "Unknown error"));
    }
  }

  // =========================
  // Step 1 submit
  // =========================
  function setHeroSearchLoading(isLoading){
    const btn = $("heroSearchBtn");
    btn.disabled = isLoading;
    btn.textContent = isLoading ? "Searching‚Ä¶" : "Search";
  }

  $("tabOneWay").addEventListener("click", ()=> setHeroMode("one_way"));
  $("tabHourly").addEventListener("click", ()=> setHeroMode("hourly"));

  $("heroSearchForm").addEventListener("submit", (e)=>{
    e.preventDefault();
    clearHeroAlert();

    const err = validateHero();
    if (err) return showHeroAlert(err);

    // save state from form
    state.pickup = val("h_pickup");
    state.dropoff = val("h_dropoff");
    state.date = $("h_date").value;
    state.time = val("h_time");
    state.transfer = val("h_transfer") || "point";
    state.hours = Math.max(3, Number(val("h_hours") || 3));

    setHeroSearchLoading(true);

    // local compute (instant)
    state.computedVehicles = buildVehiclesForTrip();
    renderTripSummary();
    renderVehiclesOverlay();

    setHeroSearchLoading(false);
    openOverlay("overlayVehicles");
  });

  // =========================
  // Init
  // =========================
  window.addEventListener("load", ()=>{
    buildTimeOptions(5, "h_time");
    buildTimeOptions(5, "time");

    const d = new Date();
    const yyyy = d.getFullYear();
    const mm = String(d.getMonth()+1).padStart(2,"0");
    const dd = String(d.getDate()).padStart(2,"0");
    $("h_date").value = `${yyyy}-${mm}-${dd}`;

    setHeroMode("one_way");
  });
</script>

<!--Start of Tawk.to Script-->
<script type="text/javascript">
var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
(function(){
var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
s1.async=true;
s1.src='https://embed.tawk.to/6987db032260861c350b5c0a/default';
s1.charset='UTF-8';
s1.setAttribute('crossorigin','*');
s0.parentNode.insertBefore(s1,s0);
})();
</script>
<!--End of Tawk.to Script-->

</body>
</html>
