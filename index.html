<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Mont-Tremblant Limo Services | Luxury Chauffeur</title>
  <meta name="description" content="Luxury chauffeur service in Mont-Tremblant. Escalade, Suburban, Denali, QX60, Tesla & Sprinter. Minimum 3 hours. Book online." />
  <link rel="canonical" href="https://www.monttremblantlimoservices.com/" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0b0f17;
      --card:#0f1626;
      --card2:#121b2f;
      --text:#eef2ff;
      --muted:rgba(238,242,255,.72);
      --muted2:rgba(238,242,255,.54);
      --line:rgba(255,255,255,.10);
      --accent:#8b5cf6;
      --accent2:#22c55e;
      --warn:#fbbf24;
      --danger:#ef4444;
      --shadow: 0 18px 60px rgba(0,0,0,.40);
      --radius: 22px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--text);
      background: radial-gradient(1200px 600px at 10% -10%, rgba(139,92,246,.35), transparent 60%),
                  radial-gradient(900px 500px at 100% 0%, rgba(34,197,94,.20), transparent 55%),
                  linear-gradient(180deg, #060811 0%, #0b0f17 38%, #070a12 100%);
      overflow-x:hidden;
    }

    a{color:inherit; text-decoration:none}
    .container{max-width:1180px; margin:0 auto; padding:0 18px}
    .btn{
      display:inline-flex; align-items:center; justify-content:center;
      gap:10px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      color:var(--text);
      padding:12px 16px;
      border-radius:14px;
      font-weight:700;
      transition: transform .08s ease, background .12s ease, border-color .12s ease;
      cursor:pointer;
      user-select:none;
      white-space:nowrap;
    }
    .btn:hover{background: rgba(255,255,255,.10); border-color: rgba(255,255,255,.18)}
    .btn:active{transform: translateY(1px)}
    .btn.primary{
      border:none;
      background: linear-gradient(135deg, rgba(139,92,246,1), rgba(34,197,94,1));
      box-shadow: 0 14px 40px rgba(139,92,246,.20);
    }
    .btn.primary:hover{filter: brightness(1.03)}
    .btn.ghost{
      background: transparent;
      border:1px solid rgba(255,255,255,.18);
    }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 12px;
      border:1px solid rgba(255,255,255,.12);
      border-radius:999px;
      background: rgba(255,255,255,.05);
      color:var(--muted);
      font-weight:700;
      font-size:12px;
    }

    /* Top nav */
    header{
      position:sticky; top:0; z-index:50;
      backdrop-filter: blur(12px);
      background: rgba(7,10,18,.60);
      border-bottom:1px solid rgba(255,255,255,.08);
    }
    .nav{
      display:flex; align-items:center; justify-content:space-between;
      padding:14px 0;
      gap:14px;
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      font-weight:900;
      letter-spacing:.2px;
    }
    .logo{
      width:34px; height:34px; border-radius:12px;
      background: linear-gradient(135deg, rgba(139,92,246,1), rgba(34,197,94,1));
      box-shadow: 0 10px 22px rgba(139,92,246,.22);
    }
    .navlinks{
      display:flex; align-items:center; gap:14px;
      color:var(--muted);
      font-weight:700;
      font-size:14px;
    }
    .navlinks a{padding:10px 10px; border-radius:12px}
    .navlinks a:hover{background: rgba(255,255,255,.06); color:var(--text)}
    .navcta{display:flex; gap:10px; align-items:center}

    /* Hero */
    .hero{
      position:relative;
      padding:56px 0 28px;
    }
    .heroGrid{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap:22px;
      align-items:start;
    }
    .heroVisual{
      position:relative;
      min-height:460px;
      border-radius: var(--radius);
      overflow:hidden;
      border:1px solid rgba(255,255,255,.10);
      box-shadow: var(--shadow);
      background:
        linear-gradient(180deg, rgba(0,0,0,.18), rgba(0,0,0,.70)),
        url("https://images.unsplash.com/photo-1528127269322-539801943592?auto=format&fit=crop&w=2400&q=80") center/cover no-repeat;
    }
    .heroOverlay{
      position:absolute; inset:0;
      background: radial-gradient(900px 520px at 10% 10%, rgba(139,92,246,.35), transparent 62%),
                  radial-gradient(800px 440px at 80% 0%, rgba(34,197,94,.26), transparent 60%);
      mix-blend-mode: screen;
      opacity:.85;
      pointer-events:none;
    }
    .heroText{
      position:absolute;
      left:22px; right:22px;
      bottom:22px;
      max-width:680px;
    }
    .heroText h1{
      margin:0 0 10px;
      font-size:44px;
      line-height:1.05;
      letter-spacing:-.6px;
    }
    .heroText p{
      margin:0 0 18px;
      color:var(--muted);
      font-size:16px;
      line-height:1.55;
      max-width:560px;
    }
    .heroBadges{display:flex; flex-wrap:wrap; gap:10px; margin-bottom:16px}
    .trustRow{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:14px;
    }

    /* Booking Card */
    .card{
      border-radius: var(--radius);
      border:1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .cardHeader{
      padding:18px 18px 12px;
      border-bottom:1px solid rgba(255,255,255,.08);
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
    }
    .cardHeader h2{
      margin:0;
      font-size:16px;
      letter-spacing:-.2px;
    }
    .stepPill{
      font-size:12px;
      color:var(--muted);
      font-weight:800;
      border:1px solid rgba(255,255,255,.12);
      padding:8px 10px;
      border-radius:999px;
      background: rgba(255,255,255,.05);
    }
    .cardBody{padding:16px 18px 18px}
    .tabs{
      display:flex; gap:10px;
      padding:6px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      border-radius:16px;
      margin-bottom:14px;
    }
    .tab{
      flex:1;
      text-align:center;
      padding:10px 12px;
      border-radius:12px;
      font-weight:900;
      color:var(--muted);
      cursor:pointer;
      transition: background .12s ease, color .12s ease;
    }
    .tab.active{
      background: rgba(255,255,255,.12);
      color:var(--text);
    }
    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    .field{display:flex; flex-direction:column; gap:8px}
    label{
      font-size:12px;
      color:var(--muted);
      font-weight:800;
      letter-spacing:.2px;
    }
    input, select, textarea{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(12,18,34,.55);
      color:var(--text);
      outline:none;
      font-weight:700;
    }
    textarea{min-height:84px; resize:vertical}
    input::placeholder, textarea::placeholder{color:rgba(238,242,255,.35); font-weight:700}
    .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
    .helper{
      color:var(--muted2);
      font-size:12px;
      line-height:1.4;
      margin-top:10px;
    }
    .notice{
      margin-top:12px;
      padding:12px 12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.05);
      color:var(--muted);
      font-weight:700;
      font-size:12px;
      line-height:1.4;
    }
    .notice strong{color:var(--text)}
    .err{
      margin-top:12px;
      padding:12px 12px;
      border-radius:16px;
      border:1px solid rgba(239,68,68,.35);
      background: rgba(239,68,68,.10);
      color: rgba(255,255,255,.88);
      font-weight:800;
      font-size:12px;
      line-height:1.4;
      display:none;
    }

    /* Results */
    .results{margin-top:14px; display:none}
    .resultsHeader{
      display:flex; align-items:flex-start; justify-content:space-between;
      gap:12px;
      margin-bottom:10px;
    }
    .resultsHeader h3{
      margin:0;
      font-size:14px;
      letter-spacing:-.2px;
    }
    .resultsHeader p{
      margin:4px 0 0;
      color:var(--muted2);
      font-size:12px;
      line-height:1.35;
      max-width:360px;
    }
    .vehicleList{display:flex; flex-direction:column; gap:10px}
    .vehicleCard{
      border-radius:18px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      overflow:hidden;
      transition: border-color .12s ease, transform .08s ease;
    }
    .vehicleCard:hover{border-color: rgba(255,255,255,.18)}
    .vehicleCard.selected{
      border-color: rgba(34,197,94,.55);
      box-shadow: 0 0 0 2px rgba(34,197,94,.18) inset;
    }
    .vehicleTop{
      padding:12px 12px;
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:space-between;
    }
    .vehicleLeft{display:flex; gap:12px; align-items:center}
    .vehicleIcon{
      width:44px; height:44px; border-radius:14px;
      background: linear-gradient(135deg, rgba(255,255,255,.12), rgba(255,255,255,.04));
      border:1px solid rgba(255,255,255,.10);
      display:flex; align-items:center; justify-content:center;
      font-weight:900; color:rgba(255,255,255,.85);
      flex:0 0 auto;
    }
    .vehicleName{font-weight:900}
    .vehicleMeta{color:var(--muted2); font-size:12px; font-weight:800; margin-top:3px}
    .priceBox{display:flex; flex-direction:column; align-items:flex-end; gap:6px}
    .price{
      font-weight:900;
      font-size:16px;
      letter-spacing:-.3px;
    }
    .priceSub{color:var(--muted2); font-size:11px; font-weight:800}
    .vehicleBottom{
      border-top:1px solid rgba(255,255,255,.08);
      padding:10px 12px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
    }
    .features{
      display:flex; gap:8px; flex-wrap:wrap;
      color:var(--muted);
      font-size:12px;
      font-weight:800;
    }
    .chip{
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
    }

    /* Sections */
    .section{padding:38px 0}
    .section h2{
      margin:0 0 12px;
      font-size:26px;
      letter-spacing:-.4px;
    }
    .section p{margin:0; color:var(--muted); line-height:1.6}
    .cards3{
      margin-top:18px;
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:14px;
    }
    .infoCard{
      border-radius: 22px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      padding:16px;
    }
    .infoCard h3{margin:0 0 6px; font-size:14px; letter-spacing:-.2px}
    .infoCard p{margin:0; font-size:13px; color:var(--muted); line-height:1.55}

    footer{
      padding:34px 0 46px;
      border-top:1px solid rgba(255,255,255,.08);
      color:var(--muted);
    }
    .footGrid{
      display:grid;
      grid-template-columns: 1.2fr 1fr 1fr;
      gap:18px;
      margin-top:16px;
    }
    .footCol h4{margin:0 0 10px; color:var(--text); font-size:13px}
    .footCol a{display:block; padding:6px 0; color:var(--muted)}
    .footCol a:hover{color:var(--text)}

    /* Responsive */
    @media (max-width: 980px){
      .heroGrid{grid-template-columns: 1fr; }
      .heroVisual{min-height:380px}
      .heroText h1{font-size:38px}
      .cards3{grid-template-columns: 1fr; }
      .footGrid{grid-template-columns: 1fr}
      .navlinks{display:none}
    }
    @media (max-width: 520px){
      .heroText h1{font-size:32px}
      .grid{grid-template-columns: 1fr}
      .hero{padding-top:26px}
    }
  </style>
</head>

<body>
  <header>
    <div class="container">
      <div class="nav">
        <div class="brand">
          <div class="logo" aria-hidden="true"></div>
          <div>
            Mont-Tremblant<br/>
            <span style="font-weight:800;color:var(--muted);font-size:12px">Luxury Chauffeur</span>
          </div>
        </div>

        <nav class="navlinks" aria-label="Primary">
          <a href="#services">Services</a>
          <a href="#fleet">Fleet</a>
          <a href="#areas">Service Areas</a>
          <a href="#faq">FAQ</a>
        </nav>

        <div class="navcta">
          <a class="btn ghost" href="tel:+15142933170">Call</a>
          <a class="btn primary" href="#book">Book now</a>
        </div>
      </div>
    </div>
  </header>

  <main>
    <section class="hero">
      <div class="container">
        <div class="heroGrid">
          <div class="heroVisual" role="img" aria-label="Mont-Tremblant luxury transportation">
            <div class="heroOverlay"></div>

            <div class="heroText">
              <div class="heroBadges">
                <span class="pill">✓ Professional chauffeurs</span>
                <span class="pill">✓ Fixed pricing</span>
                <span class="pill">✓ 24/7 service</span>
                <span class="pill">✓ 3-hour minimum for hourly</span>
              </div>

              <h1>Premium rides in Mont-Tremblant — airport, hourly, and city-to-city</h1>
              <p>Book a luxury SUV, sedan, or sprinter in minutes. Transparent pricing, smooth experience, and professional drivers for your trip.</p>

              <div class="trustRow">
                <a class="btn primary" href="#book">Get a quote</a>
                <a class="btn" href="#fleet">View fleet</a>
              </div>
            </div>
          </div>

          <!-- Booking Card -->
          <div id="book" class="card" aria-label="Booking form">
            <div class="cardHeader">
              <h2>Book your ride</h2>
              <div id="stepPill" class="stepPill">Step 1 of 2</div>
            </div>

            <div class="cardBody">
              <div class="tabs" role="tablist" aria-label="Trip type">
                <div id="tabOneWay" class="tab active" role="tab" aria-selected="true" tabindex="0">One way</div>
                <div id="tabHourly" class="tab" role="tab" aria-selected="false" tabindex="-1">By the hour</div>
              </div>

              <form id="bookingForm">
                <input type="hidden" id="mode" value="one_way" />

                <div class="grid">
                  <div class="field">
                    <label for="pickup">From</label>
                    <input id="pickup" name="pickup" placeholder="Pickup address, hotel, or airport" autocomplete="off" required />
                  </div>

                  <div class="field" id="dropoffField">
                    <label for="dropoff">To</label>
                    <input id="dropoff" name="dropoff" placeholder="Destination address" autocomplete="off" required />
                  </div>

                  <div class="field">
                    <label for="date">Date</label>
                    <input id="date" name="date" type="date" required />
                  </div>

                  <div class="field">
                    <label for="time">Time</label>
                    <input id="time" name="time" type="time" required />
                  </div>

                  <div class="field" id="hoursField" style="display:none">
                    <label for="hours">Duration (hours)</label>
                    <select id="hours" name="hours">
                      <option value="3">3 hours (minimum)</option>
                      <option value="4">4 hours</option>
                      <option value="5">5 hours</option>
                      <option value="6">6 hours</option>
                      <option value="8">8 hours</option>
                      <option value="10">10 hours</option>
                      <option value="12">12 hours</option>
                    </select>
                  </div>

                  <div class="field">
                    <label for="pax">Passengers</label>
                    <select id="pax" name="pax">
                      <option value="1">1</option>
                      <option value="2" selected>2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                      <option value="6">6</option>
                      <option value="7">7</option>
                      <option value="8">8</option>
                      <option value="9">9</option>
                      <option value="10">10</option>
                      <option value="12">12</option>
                      <option value="14">14</option>
                    </select>
                  </div>
                </div>

                <div class="field" style="margin-top:12px">
                  <label for="notes">Notes (optional)</label>
                  <textarea id="notes" name="notes" placeholder="Ski luggage, child seat, flight number, multiple stops, etc."></textarea>
                </div>

                <div class="row" style="margin-top:14px">
                  <button id="searchBtn" type="submit" class="btn primary" style="flex:1">
                    Search vehicles & prices
                  </button>
                </div>

                <div class="helper">
                  Tip: Add Google Places autocomplete later for the fastest Blacklane-like experience.
                </div>

                <div id="errorBox" class="err" role="alert"></div>
              </form>

              <!-- Results Step -->
              <div id="results" class="results" aria-live="polite">
                <div class="resultsHeader">
                  <div>
                    <h3>Select a vehicle</h3>
                    <p id="resultsSubtitle">Choose the best option for your trip. Prices shown include your configured rates.</p>
                  </div>
                  <button id="editSearchBtn" class="btn" type="button">Edit</button>
                </div>

                <div id="vehicleList" class="vehicleList"></div>

                <div class="notice">
                  <strong>Payment:</strong> You’ll be taken to secure Stripe Checkout to complete your booking.
                </div>

                <div class="row" style="margin-top:12px">
                  <button id="bookBtn" class="btn primary" type="button" style="flex:1" disabled>
                    Book selected vehicle
                  </button>
                </div>

                <div class="helper" id="policyText">
                  By booking, you agree to our cancellation & service policies. You can add a policy link in the footer.
                </div>
              </div>

            </div>
          </div>
          <!-- /Booking Card -->
        </div>
      </div>
    </section>

    <!-- Services -->
    <section id="services" class="section">
      <div class="container">
        <h2>Services</h2>
        <p>Designed for Mont-Tremblant travel: airport transfers, hourly chauffeurs, and city-to-city rides.</p>

        <div class="cards3">
          <div class="infoCard">
            <h3>Airport transfers</h3>
            <p>Reliable pickups and drop-offs for Montréal–Trudeau (YUL), private aviation, and regional airports.</p>
          </div>
          <div class="infoCard">
            <h3>Hourly chauffeur</h3>
            <p>Perfect for ski days, meetings, weddings, or a full-day show-around. Minimum 3 hours.</p>
          </div>
          <div class="infoCard">
            <h3>City-to-city</h3>
            <p>Comfortable long-distance rides with fixed prices and professional drivers.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Fleet -->
    <section id="fleet" class="section">
      <div class="container">
        <h2>Fleet</h2>
        <p>Luxury SUVs, sedans, and sprinters. Vehicle availability depends on date/time.</p>

        <div class="cards3" style="margin-top:18px">
          <div class="infoCard">
            <h3>SUV (Premium)</h3>
            <p>Chevrolet Suburban • Cadillac Escalade • GMC Denali — best for comfort and luggage.</p>
          </div>
          <div class="infoCard">
            <h3>Sedan (Executive)</h3>
            <p>Tesla / executive sedan options — ideal for couples and business travel.</p>
          </div>
          <div class="infoCard">
            <h3>Sprinter / Van</h3>
            <p>Group travel with extra space for gear and luggage (ski trips, events, families).</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Areas -->
    <section id="areas" class="section">
      <div class="container">
        <h2>Service areas</h2>
        <p>Mont-Tremblant, Laurentians, Montréal, Ottawa, Québec City, and more.</p>
      </div>
    </section>

    <!-- FAQ -->
    <section id="faq" class="section">
      <div class="container">
        <h2>FAQ</h2>
        <div class="cards3">
          <div class="infoCard">
            <h3>Do you offer fixed prices?</h3>
            <p>Yes — pricing is shown upfront during “Search”.</p>
          </div>
          <div class="infoCard">
            <h3>Can I book by the hour?</h3>
            <p>Yes — select “By the hour”. Minimum 3 hours.</p>
          </div>
          <div class="infoCard">
            <h3>How do I pay?</h3>
            <p>Secure Stripe Checkout (credit/debit). You’ll be redirected to complete payment.</p>
          </div>
        </div>
      </div>
    </section>

  </main>

  <footer>
    <div class="container">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap">
        <div class="brand">
          <div class="logo" aria-hidden="true"></div>
          <div>
            <div style="font-weight:900;color:var(--text)">Mont-Tremblant Limo Services</div>
            <div style="font-weight:800;color:var(--muted);font-size:12px">Luxury Chauffeur • 24/7</div>
          </div>
        </div>
        <div class="row">
          <a class="btn" href="tel:+15142933170">+1 (514) 293-3170</a>
          <a class="btn ghost" href="#book">Book</a>
        </div>
      </div>

      <div class="footGrid">
        <div class="footCol">
          <h4>About</h4>
          <div style="color:var(--muted);line-height:1.6;font-weight:700;font-size:13px">
            Premium transportation in Mont-Tremblant with professional chauffeurs and luxury vehicles.
          </div>
        </div>
        <div class="footCol">
          <h4>Company</h4>
          <a href="#services">Services</a>
          <a href="#fleet">Fleet</a>
          <a href="#areas">Service areas</a>
        </div>
        <div class="footCol">
          <h4>Help</h4>
          <a href="#faq">FAQ</a>
          <a href="#" onclick="alert('Add your policy page link here.');return false;">Cancellation policy</a>
          <a href="#" onclick="alert('Add your privacy page link here.');return false;">Privacy</a>
        </div>
      </div>

      <div style="margin-top:18px;color:rgba(238,242,255,.45);font-weight:800;font-size:12px">
        © <span id="year"></span> Mont-Tremblant Limo Services. All rights reserved.
      </div>
    </div>
  </footer>

  <script>
    // =========================
    // CONFIG — update these
    // =========================
    const CONFIG = {
      // Point these to YOUR booking API (or a serverless function on Vercel).
      API: {
        QUOTE_URL: "/api/quote",            // <-- change to your endpoint (or keep if you have a Vercel function)
        CHECKOUT_URL: "/api/checkout",      // <-- endpoint that creates Stripe Checkout session and returns {url}
      },

      // Your fleet (used as fallback if API doesn't return options)
      FLEET: [
        { id:"suburban", name:"Chevrolet Suburban", class:"SUV (Premium)", seats:7, bags:6, tag:"Best for ski luggage", icon:"SUV" },
        { id:"escalade", name:"Cadillac Escalade", class:"SUV (Luxury)", seats:7, bags:6, tag:"Luxury comfort", icon:"SUV" },
        { id:"denali",   name:"GMC Denali",        class:"SUV (Premium)", seats:7, bags:6, tag:"Smooth ride", icon:"SUV" },
        { id:"qx60",     name:"Infiniti QX60",     class:"SUV (Standard)",seats:6, bags:5, tag:"Great value", icon:"SUV" },
        { id:"tesla",    name:"Tesla",            class:"Sedan (Executive)", seats:4, bags:3, tag:"Quiet & premium", icon:"SED" },
        { id:"sprinter", name:"Mercedes Sprinter", class:"Van (Group)", seats:14, bags:14, tag:"Groups & gear", icon:"VAN" },
      ]
    };

    // =========================
    // UI helpers
    // =========================
    const $ = (id) => document.getElementById(id);

    const state = {
      mode: "one_way",
      quote: null,
      selectedVehicleId: null
    };

    function setMode(mode){
      state.mode = mode;
      $("mode").value = mode;

      const oneWay = mode === "one_way";
      $("dropoffField").style.display = oneWay ? "" : "none";
      $("hoursField").style.display = oneWay ? "none" : "";

      $("tabOneWay").classList.toggle("active", oneWay);
      $("tabHourly").classList.toggle("active", !oneWay);

      $("tabOneWay").setAttribute("aria-selected", oneWay ? "true":"false");
      $("tabHourly").setAttribute("aria-selected", !oneWay ? "true":"false");

      $("dropoff").required = oneWay;
    }

    function showError(msg){
      const el = $("errorBox");
      el.textContent = msg;
      el.style.display = "block";
    }
    function clearError(){
      const el = $("errorBox");
      el.textContent = "";
      el.style.display = "none";
    }

    function toISO(date, time){
      // date: YYYY-MM-DD, time: HH:MM
      if(!date || !time) return null;
      return `${date}T${time}:00`;
    }

    function setStep(step){
      $("stepPill").textContent = step === 1 ? "Step 1 of 2" : "Step 2 of 2";
    }

    function showResults(show){
      $("results").style.display = show ? "block" : "none";
      setStep(show ? 2 : 1);
    }

    // =========================
    // API integration points
    // =========================
    async function fetchQuote(payload){
      // Try your API first. If it fails, we fall back to a local estimate list.
      // Expected API response example:
      // { currency:"CAD", vehicles:[ {id:"suburban", total: 320, label:"Chevrolet Suburban", seats:7, bags:6, etaText:"Fixed price"} ] }
      try{
        const res = await fetch(CONFIG.API.QUOTE_URL, {
          method: "POST",
          headers: { "Content-Type":"application/json" },
          body: JSON.stringify(payload)
        });
        if(!res.ok) throw new Error("Quote API returned an error.");
        return await res.json();
      }catch(err){
        // Fallback demo pricing (replace with your real server pricing ASAP)
        const base = payload.mode === "hourly" ? 140 : 240;
        const hours = payload.hours || 0;
        const multiplier = payload.mode === "hourly" ? hours : 1;

        return {
          currency: "CAD",
          vehicles: CONFIG.FLEET.map((v, i) => ({
            id: v.id,
            label: v.name,
            class: v.class,
            seats: v.seats,
            bags: v.bags,
            tag: v.tag,
            icon: v.icon,
            total: Math.round((base + i*25) * (multiplier || 1)),
            priceNote: payload.mode === "hourly" ? `Total for ${hours}h` : "One-way fixed price"
          })),
          _fallback: true
        };
      }
    }

    async function startStripeCheckout(payload){
      // Your backend should create a Stripe Checkout Session and return a URL:
      // { url: "https://checkout.stripe.com/..." }
      // You can also return {sessionId:"..."} and use Stripe.js — but URL redirect is simplest.
      const res = await fetch(CONFIG.API.CHECKOUT_URL, {
        method:"POST",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify(payload)
      });
      if(!res.ok) throw new Error("Checkout API returned an error.");
      const data = await res.json();
      if(!data.url) throw new Error("Checkout API did not return a URL.");
      window.location.href = data.url;
    }

    // =========================
    // Results rendering
    // =========================
    function formatMoney(amount, currency){
      try{
        return new Intl.NumberFormat("en-CA", { style:"currency", currency: currency || "CAD" }).format(amount);
      }catch(e){
        return `${amount} ${currency || ""}`.trim();
      }
    }

    function renderVehicles(quote){
      const list = $("vehicleList");
      list.innerHTML = "";
      state.selectedVehicleId = null;
      $("bookBtn").disabled = true;

      const currency = quote.currency || "CAD";
      const vehicles = Array.isArray(quote.vehicles) ? quote.vehicles : [];

      vehicles.forEach(v => {
        const card = document.createElement("div");
        card.className = "vehicleCard";
        card.dataset.id = v.id;

        const icon = (v.icon || "CAR").toString().slice(0,3).toUpperCase();
        const seatText = (v.seats ? `${v.seats} seats` : "Comfortable");
        const bagText  = (v.bags ? `${v.bags} bags` : "Luggage friendly");

        card.innerHTML = `
          <div class="vehicleTop">
            <div class="vehicleLeft">
              <div class="vehicleIcon" aria-hidden="true">${icon}</div>
              <div>
                <div class="vehicleName">${escapeHtml(v.label || v.name || "Vehicle")}</div>
                <div class="vehicleMeta">${escapeHtml(v.class || "")}</div>
              </div>
            </div>
            <div class="priceBox">
              <div class="price">${formatMoney(Number(v.total || 0), currency)}</div>
              <div class="priceSub">${escapeHtml(v.priceNote || "All-in price")}</div>
            </div>
          </div>
          <div class="vehicleBottom">
            <div class="features">
              <span class="chip">${escapeHtml(seatText)}</span>
              <span class="chip">${escapeHtml(bagText)}</span>
              ${v.tag ? `<span class="chip">${escapeHtml(v.tag)}</span>` : ``}
            </div>
            <button class="btn" type="button">Select</button>
          </div>
        `;

        const selectBtn = card.querySelector("button");
        const onSelect = () => {
          // Unselect others
          document.querySelectorAll(".vehicleCard").forEach(el => el.classList.remove("selected"));
          card.classList.add("selected");
          state.selectedVehicleId = v.id;
          $("bookBtn").disabled = false;
        };

        selectBtn.addEventListener("click", onSelect);
        card.addEventListener("click", (e) => {
          // Prevent double firing if user clicks button
          if(e.target.tagName.toLowerCase() === "button") return;
          onSelect();
        });

        list.appendChild(card);
      });
    }

    function escapeHtml(str){
      return String(str ?? "")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    // =========================
    // Events
    // =========================
    $("tabOneWay").addEventListener("click", () => setMode("one_way"));
    $("tabHourly").addEventListener("click", () => setMode("hourly"));

    $("tabOneWay").addEventListener("keydown", (e) => { if(e.key==="Enter"||e.key===" "){ e.preventDefault(); setMode("one_way"); }});
    $("tabHourly").addEventListener("keydown", (e) => { if(e.key==="Enter"||e.key===" "){ e.preventDefault(); setMode("hourly"); }});

    $("editSearchBtn").addEventListener("click", () => {
      showResults(false);
      clearError();
      window.location.hash = "#book";
    });

    $("bookingForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      clearError();

      const pickup = $("pickup").value.trim();
      const dropoff = $("dropoff").value.trim();
      const date = $("date").value;
      const time = $("time").value;
      const pax = Number($("pax").value || 1);
      const notes = $("notes").value.trim();
      const iso = toISO(date, time);

      if(!pickup) return showError("Please enter a pickup location.");
      if(state.mode === "one_way" && !dropoff) return showError("Please enter a destination.");
      if(!iso) return showError("Please choose date and time.");

      if(state.mode === "hourly"){
        const hrs = Number($("hours").value || 3);
        if(hrs < 3) return showError("Hourly bookings require a minimum of 3 hours.");
      }

      const payload = {
        mode: state.mode === "one_way" ? "one_way" : "hourly",
        pickup,
        dropoff: state.mode === "one_way" ? dropoff : null,
        datetime: iso,
        hours: state.mode === "hourly" ? Number($("hours").value || 3) : null,
        passengers: pax,
        notes
      };

      // UI state
      const btn = $("searchBtn");
      btn.disabled = true;
      btn.textContent = "Searching…";

      try{
        const quote = await fetchQuote(payload);
        state.quote = { ...quote, request: payload };

        renderVehicles(quote);
        showResults(true);

        const subtitle = quote._fallback
          ? "Demo pricing shown (fallback). Connect your API for live rates."
          : "Select a vehicle to continue to booking.";
        $("resultsSubtitle").textContent = subtitle;

      }catch(err){
        showError(err?.message || "Something went wrong while searching. Please try again.");
      }finally{
        btn.disabled = false;
        btn.textContent = "Search vehicles & prices";
      }
    });

    $("bookBtn").addEventListener("click", async () => {
      clearError();
      if(!state.quote || !state.selectedVehicleId){
        return showError("Please select a vehicle first.");
      }

      const selected = (state.quote.vehicles || []).find(v => v.id === state.selectedVehicleId);
      if(!selected) return showError("Selected vehicle is not available. Please search again.");

      // Payload for your Checkout endpoint
      // Send everything your backend needs to create booking + Stripe session
      const checkoutPayload = {
        ...state.quote.request,
        vehicleId: state.selectedVehicleId,
        vehicleLabel: selected.label || selected.name,
        total: selected.total,
        currency: state.quote.currency || "CAD"
      };

      const btn = $("bookBtn");
      btn.disabled = true;
      btn.textContent = "Redirecting to payment…";

      try{
        await startStripeCheckout(checkoutPayload);
      }catch(err){
        showError(err?.message || "Could not start payment. Please try again.");
        btn.disabled = false;
        btn.textContent = "Book selected vehicle";
      }
    });

    // Year in footer
    $("year").textContent = new Date().getFullYear();

    // Default date/time to soon-ish (nice UX)
    (function setDefaultDateTime(){
      const now = new Date();
      now.setMinutes(now.getMinutes() + 30);
      const yyyy = now.getFullYear();
      const mm = String(now.getMonth()+1).padStart(2,"0");
      const dd = String(now.getDate()).padStart(2,"0");
      const hh = String(now.getHours()).padStart(2,"0");
      const mi = String(now.getMinutes()).padStart(2,"0");
      $("date").value = `${yyyy}-${mm}-${dd}`;
      $("time").value = `${hh}:${mi}`;
    })();

    // Start mode
    setMode("one_way");
  </script>

  <!-- =========================
       PASTE YOUR STRIPE/Tawk SCRIPTS BELOW
       ========================= -->

  <!-- Example: Tawk.to (replace with your existing snippet) -->
  <!--
  <script type="text/javascript">
    var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
    (function(){
      var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
      s1.async=true;
      s1.src='https://embed.tawk.to/YOUR_ID/default';
      s1.charset='UTF-8';
      s1.setAttribute('crossorigin','*');
      s0.parentNode.insertBefore(s1,s0);
    })();
  </script>
  -->

  <!-- If you already include Stripe.js for other pages, keep it. This page uses redirect URL flow from your backend. -->
  <!-- <script src="https://js.stripe.com/v3"></script> -->
</body>
</html>
