<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Mont Tremblant Limo Services | Reserve Online</title>
<meta name="description" content="Luxury chauffeur & limo service in Mont-Tremblant. Reserve online with instant pricing and secure payment." />

<style>
body{
  font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background:#0b1220;
  color:#fff;
  margin:0;
}
.container{max-width:1100px;margin:auto;padding:20px}
h1,h2{margin-bottom:10px}
input,select,textarea,button{
  width:100%;
  padding:12px;
  border-radius:8px;
  border:none;
  margin-bottom:12px;
  font-size:15px
}
textarea{min-height:90px}
button{
  background:#e4c36a;
  color:#000;
  font-weight:800;
  cursor:pointer
}
button:hover{opacity:.9}
.card{
  background:#111a2e;
  border-radius:12px;
  padding:20px;
  margin-top:20px
}
.row{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px
}
@media(max-width:800px){.row{grid-template-columns:1fr}}
.note{font-size:13px;opacity:.8}
.price-box{
  background:#1a2646;
  padding:14px;
  border-radius:10px;
  font-weight:700
}
</style>
</head>

<body>

<div class="container">
  <h1>Mont Tremblant Limo Services</h1>
  <p>Luxury chauffeur service • Full payment required to reserve</p>

  <div class="card">
    <h2>Instant Reservation</h2>

    <form id="bookingForm">
      <div class="row">
        <input id="name" placeholder="Full Name" required />
        <input id="phone" placeholder="Phone (optional)" />
      </div>

      <div class="row">
        <input id="date" type="date" required />
        <input id="time" type="time" required />
      </div>

      <input id="pickup" placeholder="Pickup location" required />
      <input id="dropoff" placeholder="Drop-off location" required />

      <div class="row">
        <select id="triptype">
          <option value="hourly">Hourly (3-hour minimum)</option>
          <option value="point">Point-to-Point</option>
          <option value="airport">Airport Transfer</option>
        </select>

        <select id="vehicle">
          <option value="">Select vehicle</option>
          <option value="Escalade">Cadillac Escalade — $150/hr</option>
          <option value="Suburban">Chevrolet Suburban — $120/hr</option>
          <option value="Denali">GMC Yukon Denali — $120/hr</option>
          <option value="QX60">Infiniti QX60 — $99/hr</option>
          <option value="Tesla">Tesla Model Y — $75/hr</option>
          <option value="Sprinter">Mercedes Sprinter — $250/hr</option>
        </select>
      </div>

      <select id="hours">
        <option value="3">3 hours (minimum)</option>
        <option value="4">4 hours</option>
        <option value="5">5 hours</option>
        <option value="6">6 hours</option>
        <option value="8">8 hours</option>
      </select>

      <textarea id="notes" placeholder="Passengers, luggage, flight number, notes…"></textarea>

      <div class="price-box">
        Estimated Total: <span id="estimate">$0</span>
      </div>

      <button type="button" onclick="reserveNow()">Reserve Now (Pay Online)</button>
      <p class="note">Secure payment powered by Stripe • Full payment required</p>
    </form>
  </div>
</div>

<script>
const RATES={
  Escalade:150,
  Suburban:120,
  Denali:120,
  QX60:99,
  Tesla:75,
  Sprinter:250
};

function $(id){return document.getElementById(id).value}

function calculate(){
  const vehicle=$("vehicle");
  const trip=$("triptype");
  const hours=Math.max(3,parseInt($("hours")));
  if(!RATES[vehicle]) return 0;

  if(trip==="hourly") return RATES[vehicle]*hours;
  if(trip==="airport") return RATES[vehicle]*3+60;
  return RATES[vehicle]*3+40;
}

["vehicle","triptype","hours"].forEach(id=>{
  document.getElementById(id).addEventListener("change",()=>{
    document.getElementById("estimate").textContent="$"+calculate();
  });
});

async function reserveNow(){
  const amount=calculate();
  if(!amount){alert("Please select vehicle");return;}

  const payload={
    name:$("name"),
    phone:$("phone"),
    date:$("date"),
    time:$("time"),
    pickup:$("pickup"),
    dropoff:$("dropoff"),
    triptype:$("triptype"),
    vehicle:$("vehicle"),
    hours:$("hours"),
    notes:$("notes"),
    estimate_text:"Full payment reservation",
    estimate_total_cad:amount,
    pay_now_cad:amount
  };

  const res=await fetch("/api/create-checkout-session",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify(payload)
  });

  const data=await res.json();
  if(data.url) window.location.href=data.url;
  else alert("Payment error");
}
</script>

</body>
</html>
